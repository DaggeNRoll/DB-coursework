<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Врач</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.12.1/b-2.2.3/date-1.1.2/r-2.3.0/sc-2.0.6/sp-2.0.1/sl-1.4.0/datatables.min.css"/>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.12.1/b-2.2.3/date-1.1.2/r-2.3.0/sc-2.0.6/sp-2.0.1/sl-1.4.0/datatables.min.js"></script>

    <link href="../css/style2.css" rel="stylesheet">
    <link href="https://unpkg.com/survey-jquery/survey.min.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <script src="https://unpkg.com/survey-jquery@1.9.29/survey.jquery.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/survey-jquery"></script>
    <script src="../js/dataTables.altEditor.free.js" ></script>

</head>

<body screen_capture_injected="true" class="bg-dark">
<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#"><i><img width="70" height="70" src = "../images/logo.png" alt="My Happy SVG"/></i>НМИЦ Кардиологии</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-nav">
        <div class="nav-item text-nowrap">
            <a class="nav-link px-3" href="#">Sign out</a>
        </div>
    </div>
</header>
<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse" style="height: 100%">
            <div class="position-sticky pt-3">
                <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                    <span>Навигация</span>
                    </a>
                </h6>
                <hr>
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="../html/PatientsList-2.html" class="nav-link text-white" >
                            Список Пациентов
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../html/PatientQuestioning.html" class="nav-link active" aria-current="page">
                            Визит 0
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link text-white">
                            Визит 1
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link text-white">
                            Визит 2
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link text-white">
                            Визит 3
                        </a>
                    </li>
                </ul>
                <hr>
                <nav class="nav nav-tabs flex-column mb-auto" id="nav-tab" role="tablist">
                    <a class="nav-link active" id="nav-Patient-tab" data-bs-toggle="tab" href="#nav-Patient" role="tab" aria-controls="nav-Patient" aria-selected="true">Выбор пациента</a>
                   <!-- <a class="nav-link " id="nav-CDH0-tab" data-bs-toggle="tab" href="#nav-CDH0" role="tab" aria-controls="nav-CDH0" aria-selected="false">Клинико-демографическая характеристика</a>
                    <a class="nav-link" id="nav-KVkl0-tab" data-bs-toggle="tab" href="#nav-KVkl0" role="tab" aria-controls="nav-KVkl0" aria-selected="false">Критерии включения</a>
                    <a class="nav-link" id="nav-Kiskl0-tab" data-bs-toggle="tab" href="#nav-KIskl0" role="tab" aria-controls="nav-KIskl0" aria-selected="false">Критерии исключения</a> -->
                </nav>
            </div>
        </nav>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-Patient" role="tabpanel" aria-labelledby="nav-CDH0-tab">
                    <hr>

                    <div>
                        <table cellpadding="0" cellspacing="0" border="0" class="dataTable table table-striped" id="patients"></table>
                    </div>
                   <!-- <div id="CDHOsurv" class="shadow card" style="display:inline-block;width:100%;"></div>
                    <div id="CDHOres"></div>
                    <script type="text/javascript" src="../js/CDH0.js"></script>-->

                </div>
                <!--<div class="tab-pane fade padding-top" id="nav-CDH0" role="tabpanel" aria-labelledby="nav-CDH0-tab">

                        <div id="CDHOsurv" class="shadow card" style="display:inline-block;width:100%;"></div>
                        <div id="CDHOres"></div>
                        <script type="text/javascript" src="../js/CDH0.js"></script>

                </div>
                <div class="tab-pane fade padding-top" id="nav-KVkl0" role="tabpanel" aria-labelledby="nav-KVkl0-tab">

                    <div id="KVkl0surv" class="shadow card" style="display:inline-block;width:100%;"></div>
                    <div id="KVkl0res"></div>
                    <script type="text/javascript" src="../js/KVkl0.js"></script>

                </div>
                <div class="tab-pane fade padding-top" id="nav-KIskl0" role="tabpanel" aria-labelledby="nav-KIskl0-tab">

                    <div id="KIskl0surv" class="shadow card" style="display:inline-block;width:100%;"></div>
                    <div id="KIskl0res"></div>
                    <script type="text/javascript" src="../js/KIskl0.js"></script>

                </div>-->
            </div>
        </main>
    </div>
</div>

<script>
    $(document).ready(function() {


        var columnDefs = [
            {
                data: "id",
                title: "Номер",
            },
            {
                data: "name",
                title: "ФИО"
            },
            {
                data: "phoneNumber",
                title: "Телефон"
            },
            {
                data: "age",
                title: "Возраст"
            },
            {
                data: "ac",
                title: "Номер АК"
            },
            {
                data: "group",
                title: "Группа"
            }
        ];

        var myTable = $('#patients').DataTable({
            "sPaginationType": "full_numbers",

            ajax: {
                //url : '/api/patients',
                url : '../js/tsconfig.json',
                //type: 'GET',
                //data: rowdata,
                //success: success,
                //error: error,
                // our data is an array of objects, in the root node instead of /data node, so we need 'dataSrc' parameter
                dataSrc : ''
            },
            columns: columnDefs,
            dom: 'Bfrtip',        // Needs button container
            select: 'single',
            responsive: true,
            altEditor: true,     // Enable altEditor
            buttons: [
                {
                    extend: 'selected',
                    text: 'Get selected data',
                    className: 'btn-primary',
                    action: async function () {
                        //var count = myTable.row( { selected: true } ).data().id;
                        //alert( JSON.stringify(myTable.row( { selected: true } ).data()));

                        $.ajax({
                            url:'/api/visit/0',
                            //url:'js/tsconfig.json',
                            type: 'GET',
                            data: JSON.stringify(myTable.row( { selected: true } ).data()),
                            contentType: 'application/json;charset=utf-8',
                            success: function(response){
                                var rest = response;
                                sessionStorage.setItem('visit', rest);
                                window.location.href='../html/PatientQuestioning_2.html';

                            },
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                                alert("Возникла ошибка");
                                window.location.href='../html/PatientQuestioning_2.html';
                            }
                        });
                        //const message = await response.json();
                        //if (a){

                        //}else
                        //
                            //window.location.href='../html/PatientsList-2.html';
                        //}
                    }
                }
            ],

            language: {
                altEditorUrl: '../../russian.json',
                url: '//cdn.datatables.net/plug-ins/1.12.0/i18n/ru.json'
            }
        });

        /*
        $('#select').on( 'click', function () {
                var a = myTable.rows( { selected: true } ).data().id;
                alert(a);
        });
        $('#patients').on( 'click', 'tr', function () {
            var id = myTable.row( this ).data().id;

            alert( 'Clicked row id '+id );
        } );

         */
    });
</script>

<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" type="text/javascript"></script>
</body>
</html>